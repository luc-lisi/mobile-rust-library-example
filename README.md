# Mobile Rust Template

The purpose of this repo is to serve as an example/template of a project which implements a shared Rust library between IOS and Android mobile apps. In this example, we implement a very important, business critical Rust library which is responsible for fetching a picture of a dog from the lovely open API: https://dog.ceo/dog-api/documentation/.

The example applications using this library let you select a dog breed or simply request a random dog image.

While this example possibly risks being [too silly](https://www.youtube.com/watch?v=qfwTRVnO5No), the purpose here is to show how we can use Rust to implement some shared library across two completely different apps written in both Swift and Kotlin using [uniffi-rs](https://github.com/mozilla/uniffi-rs).

## Overview

This project is organized into 3 main sub directories:

1. `rust/`
2. `bindings/`
3. `example_apps/`

Let's quickly describe what each directory is doing in order of importance.

### Directories
#### Rust Library

`rust/`  contains a [workspace](https://doc.rust-lang.org/book/ch14-03-cargo-workspaces.html) which includes the library's main source code (`dogs/`) as well as a crate to handle the generation of the Rust bindings (`uniffi-bindgen/`).

This directory also contains the compiled Rust code in `rust/target/` which will only be seen after running the make command to build the bindings locally for the first time. `target/release` will contain both static and dynamic lib files once built.

#### Bindings

`bindings/` contains both `kotlin/` and `swift/` bindings. These are imported and used by our example apps.

#### Example Apps
`example_apps` contains both an `android` and `ios` application that renders a glorious dog picture on the screen of your phone using our Rust library!

### Building the Rust bindings

To make it easy to build the Rust bindings for Swift and Kotlin, I've included a top-level Makefile which should handle both compiling, and linking of the compiled code to uniffi to build the bindings for us.

To do this simply run:

```sh
make build-bindings
```

You should see two new directories appear being `rust/target/` and `rust/bindings/`. The `target` directory contains the `.so` or `.dylib` file generated by `cargo build --release`.

This lib file is then used by uniffi's CLI to generate the `bindings/` directory which houses our Kotlin and Swift code.

**NOTE:** This Makefile assumes you are running either OSX or Linux. If you are on a Windows machine or some different OS, I wish you good luck and godspeed. Hopefully you just have to manually edit the Makefile to include the correct dynamic library extension for that OS.

### Building and running the example apps


## Step-by-step Walkthrough

### Initial Repo Setup

#### Rust

##### Dependencies

The core dependency used here is [unnifi](https://github.com/mozilla/uniffi-rs) which lets us generate bindings for non-Rust languages such as Kotlin and Swift.

#### Android

##### Dependencies

#### IOS

##### Dependencies
